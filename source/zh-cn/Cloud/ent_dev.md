title: 企业应用开发
---

# 概述

企业应用是指企业将设备接入机智云后，企业需要获取设备数据用于实现企业特定的业务管理功能，以实现企业对设备、设备消费者的运营管理需要。通常企业应用在开发过程中，不仅需要通过机智云平台获取接入设备的数据，也需要通过企业API去控制设备、进行设备数据的统计分析。让企业集中精力关注企业应用的整体业务。


## SNoti服务
SNoti服务是一个实时设备消息传输服务，该服务可以实时将企业的设备数据推送到企业应用系统，企业应用系统基于设备数据实现业务需求。

SNoti服务的能力
-  基于消息发布/订阅模型
-  设备数据传输平均时长40-50ms
-  支持多客户端同时请求
-  支持SSL传输
-  设备消息默认缓存3天，并可按企业需求定制
-  提供设备消息的监控预警


## 企业API
企业API是从接入机智云平台的企业的运营管理的需求出发，基于企业接入到机智云平台所产生的数据，为企业提供企业视角全局的设备管理、数据分析等功能，让企业更关注业务管理系统本身，减少不必要的开发成本与时间。
# 案例介绍
## 充电桩SaaS平台
充电桩SaaS平台是充电桩运营商为电动车主提供了寻找电桩、预约、充电、支付等功能，运营商通过运营管理平台对充电桩、故障、订单、计费规则、订单管理、结算等管理功能。充电桩运营商通过充电桩SaaS平台可以完整闭环的管理日常业务，大大提高运营效率。

 充电桩设备接入了机智云，充电桩SaaS平台需要实时获得充电桩的数据，根据这些数据才能计算充电费用，是否有故障等。这些设备数据正是由机智云PaaS平台负责采集，并通过SNoti服务实时推送给充电桩SaaS平台。

 充电桩SaaS平台还可以通过企业API开放的接口进行统计分析，如设备的位置服务查询，设备通信数据查询，充电桩故障数查询等功能

## 分时租赁系统
分时租赁平台的业务其实与充电桩SaaS平台类似，对于分时租赁的运营管理方，如运营汽车租赁、自行车租赁的企业。这些企业需要建设一套分时租赁管理平台，实现订单、结算、支付等必要功能。

汽车、自行车接入到机智云，企业就无需在设备的物联接入进行投入，企业只需通过接入协议接入SNoti服务即可获取设备数据进行业务开发。


# 开发流程
## SNoti服务接入

### 1、提出申请
第一步：企业开发者登陆新版开发者中心

https://developer.gizwits.com/#/login

点击右上角【账号】-【企业信息】-【服务中心】，如下图

![4](https://xbgroup-1251025085.cos.ap-guangzhou.myqcloud.com/cybertron/users/409949/media/4_1610349249206.png)

第二步：选择左侧组织，再点击【数据推送服务】，点击【立即开通】，申请开通后等待审核。

![5](https://xbgroup-1251025085.cos.ap-guangzhou.myqcloud.com/cybertron/users/409949/media/5_1610349249197.png)

第三步：待审核通过后，点击【返回旧版】，需返回旧版开发者中心使用此功能。（由于新版功能还在开发完善中，部分功能仍会在旧版使用中）。

![6](https://xbgroup-1251025085.cos.ap-guangzhou.myqcloud.com/cybertron/users/409949/media/6_1610349249202.png)

### 2、获取参数

选择产品，然后再点击【Snoti 服务】，点击“新建授权”创建，该 auth_id 拥有获取该产品下所有设备消息和控制设备的权限；

![7](https://xbgroup-1251025085.cos.ap-guangzhou.myqcloud.com/cybertron/users/409949/media/7_1610349249392.png)

### 3、理解协议
具体协议请点击 [SNoti服务接口协议](./NotificationAPI.html)


### 4、按需实现客户端
企业根据Demo Code，根据自己的需求实现客户端功能开发，可以以Demo Code为原型，实现接收到设备数据后的业务逻辑。如：
- 解析SNoti服务推送的JSON报文
- 实时将获取的消息Publish到企业应用所属的队列中，进行异步操作；
- 也可直接解析后，将数据写入数据库；但需要建立数据的定期清理策略

### 5、通过虚拟设备模拟真实设备推送数据
企业如果还没有真实设备接入到机智云，可以使用虚拟设备模拟一遍。
- 启动Demo Code，前提是已经修改为正确的product_key,auth_id与auth_secret

- 在该产品下并定义了数据点

- 审批通过后即可启动虚拟设备，并模拟数据，点击”推送“

- Demo Code会实时打印SNoti服务推送的设备状态数据




## 使用企业API

### 1、默认开通企业API服务

注册开发者中心的企业用户默认开通企业API。企业开发者登录新版开发者中心

https://developer.gizwits.com/#/login

可查看已开通的服务，如下图

### ![2](https://xbgroup-1251025085.cos.ap-guangzhou.myqcloud.com/cybertron/users/409949/media/2_1610349249174.png)

### 2、获取参数

登陆新版开发者中心，点击右上角的【账号】，选择【企业信息】，选择左侧有权限可管理的组织，然后点击【API配置】，即可获取Eid,Esecret，也可以在此设置IP白名单。如下图

![3](https://xbgroup-1251025085.cos.ap-guangzhou.myqcloud.com/cybertron/users/409949/media/3_1610349249188.png)

### 3、理解协议
企业API申请后，企业就可以通过理解企业API协议进行接口调用

点击 [企业API](./enterprise_api.html)
